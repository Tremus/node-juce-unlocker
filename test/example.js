const unlocker = require('node-juce-unlocker');

// RSA KEY
// BITS 1024
const n = "130815343604403681907804181420059910679003173997282569900819131582533095518329095347989250676119597206357948108123523717674033299280577749162529313755562868919961992982284577442392008269755638556802757474821309442495464913524797369286449600652955263293643156936230068747257110370395545847083386500015060986541"
const e = "65537"
const d = "108651168018348499584776614847156890275572268645102493666345542051543768990787000428415992218948350317128983465362890680442355533206275670539755492436705299548609291385515368540637439125694948798800199877723320779676156847136974734509865557435998786943037442124085073261663722076838972703746450080894823633121"
const p = "44602211864629968656418418594109325204921892333920133655439649931794597882056610922044125309894362517304918397720096025154735718640719494434968779521894021460114613"
const q = "293293399891097439896117379901642093090026510252182265971670819286827702420580942363802020630902277498278692003315558033572195695925534961548725"

const hex_n = "ba498817c1a8fe98c4e7184d7c493c190ae19750f5ee64fad58eb905f000013ae77a8ffddfeda3c3a6569cde9fadefa6036ea191f1b6f8a3edb2e2c83ac2349be7879128ef9392e90e24298c3571db10afc07d0f6e46d76d2cb753c2dc6c98faf3bfe582b0f8ce2d5ea35ece9570d3ef18b5df4bd59201ccf7edd2ec5930aaad"
const hex_e = "10001"
const hex_d = "9ab97238d117ed06b41c8159f24ddd85ab3cfdf237a1deeb5baf244c232fcdd5bfe7536b78af2762dc6879f88a45ec9345ac80b3f84091b98e371316b8cf045f5f9112f61586aacdc67e1adc91927a41ea4aa316c92812c1bb9feeecb3d19764f94809bca817816a5ff7eaa6327382371d0442f38dfe325037be24624eef10e1"
// const hex_p = "c647a86684128ed039e1d8ff4ebb78d61e51970f7f0bbb1fa24d8aa2083ffa3b1cbb39a534aa3435880fd37f784c3ceea92aee9caa9cd456a76799bf5afe1b657bd3bcb5"
// const hex_q = "f08425ca016bd5be96300452e38209ce71157048933cfcbc8bd4c7cf61e4e73cb8048e2e540ab6efca5d9625f506a63f783ae9a374bbb367a3c9691"

const app_name   = "MyAwesomeApp"
const username   = "EmperorPapadopoulosIII"
const email      = "example@emailcom"
const machine_id = "abcdef"

// 30 days
const expDelta = 60 * 60 * 24 * 30 * 1000;
const expiry_date = `${Date.now() + expDelta}`;
// Juce keys
const priv_key = `${hex_d},${hex_n}`;
const pub_key  = `${hex_e},${hex_n}`;

const output =  unlocker.unlock(app_name, email, username, machine_id, expiry_date, priv_key);
console.log(output);

const message = "SUPER SECRET MESSAGE";
const encryptedMessage = unlocker.encrypt(message, priv_key);
console.log(encryptedMessage);
const decrypted = unlocker.decrypt(encryptedMessage, pub_key);
console.log(decrypted);
